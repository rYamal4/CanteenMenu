<div class="row">
    <div class="col-md-12">
        <h1>Меню столовой</h1>
        <hr>
    </div>
</div>

<div class="row mb-3">
    <div class="col-md-6">
        <a href="/dishes/add" class="btn btn-success">+ Добавить блюдо</a>
    </div>
    <div class="col-md-6">
        <form method="GET" action="/dishes" class="d-flex">
            <select name="category_id" class="form-select me-2" onchange="this.form.submit()">
                <option value="">Все категории</option>
                {{#each categories}}
                    <option value="{{this.id}}" {{#if (eq this.id ../selectedCategory)}}selected{{/if}}>
                        {{this.name}}
                    </option>
                {{/each}}
            </select>
            {{#if selectedCategory}}
                <a href="/dishes" class="btn btn-secondary">Сбросить</a>
            {{/if}}
        </form>
    </div>
</div>

{{#if dishes.length}}
<div class="row">
    {{#each dishes}}
    <div class="col-md-4 mb-3">
        <div class="card h-100">
            <div class="card-body">
                <h5 class="card-title">{{this.name}}</h5>
                <h6 class="card-subtitle mb-2 text-muted">{{this.category_name}}</h6>
                {{#if this.description}}
                <p class="card-text">{{this.description}}</p>
                {{/if}}
                <p class="card-text">
                    <strong>Цена:</strong> {{this.price}} руб.<br>
                    {{#if this.weight}}
                    <strong>Вес:</strong> {{this.weight}} г<br>
                    {{/if}}
                    <strong>Доступность:</strong>
                    {{#if this.is_available}}
                        <span class="badge bg-success">Доступно</span>
                    {{else}}
                        <span class="badge bg-danger">Недоступно</span>
                    {{/if}}
                </p>
            </div>
            <div class="card-footer">
                <a href="/dishes/{{this.id}}/details" class="btn btn-sm btn-info">Подробнее</a>
                <a href="/dishes/{{this.id}}/edit" class="btn btn-sm btn-warning">Редактировать</a>
                <form method="POST" action="/dishes/{{this.id}}/delete" style="display:inline;" onsubmit="return confirm('Вы уверены, что хотите удалить это блюдо?');">
                    <button type="submit" class="btn btn-sm btn-danger">Удалить</button>
                </form>
            </div>
        </div>
    </div>
    {{/each}}
</div>
{{else}}
<div class="alert alert-info">
    Блюда не найдены.
    {{#if selectedCategory}}
        Попробуйте выбрать другую категорию или <a href="/dishes">посмотреть все блюда</a>.
    {{else}}
        <a href="/dishes/add">Добавьте первое блюдо</a>.
    {{/if}}
</div>
{{/if}}
